-- 46. Subqueries VS Joins

-- Find clients without invoices using subquery

select * 
from clients
where client_id not in (
	select distinct client_id
	from invoices
);




-- Find clients without invoices using joins

select * 
from clients c
left join invoices i
using (client_id) 
where invoice_id is null;




-- Exercise 147.png and 148.png

-- Solution using Subqueries
select customer_id,
       first_name,
       last_name
from customers 
where customer_id in (
		select customer_id
		from orders
		where order_id in (
			Select order_id
			from order_items
			where product_id = 3
	    )
);


-- Solution using Joins

Select 
       distinct c.customer_id,
       c.first_name,
       c.last_name
from customers c
join orders o
on c.customer_id=o.customer_id
join order_items oi
on o.order_id=oi.order_id
where oi.product_id=3;

